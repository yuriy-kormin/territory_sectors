{% extends "base.html" %}
{% load bootstrap4 %}
{% load i18n %}
{% load qr_code %}
{% load static %}
{% block page_content %}
    {% if request.user.is_authenticated %}
        {% qr_from_text request.build_absolute_uri size="t" image_format="png" error_correction="L" %}
        {#        <img src="{% qr_url_from_data "Hello World!" size=8 version=10 image_format='png' %}" alt="Hello World!">#}
{#        {{ requ }}#}
{#    <img src="data:image/png;base64,{{ qr_img_data }}">#}
    {% endif %}
        <div id="accordion">
            {% for house in object.sector.get_houses_into %}
              <div class="card">
                <div class="card-header" id="headingOne">
                  <h5 class="mb-0">
                    <button class="btn btn-link" data-toggle="collapse" data-target="#collapse{{ house.id }}" aria-expanded="true" aria-controls="collapse{{ house.id }}">
                        {{house.address}}({{ house.flat_count }} addresses)
                    </button>
                  </h5>
                </div>

                <div id="collapse{{ house.id }}" class="collapse" aria-labelledby="heading{{ house.id }}" data-parent="#accordion">
                  <div class="card-body">
                      <table class = "table table-striped">
                        {% for flat in house.flat_set.all %}
                            <tr>
                                <td>{{ flat.entrance }} подъезд</td>
                                <td>{{ flat.floor }} этаж </td>
                                <td>{{ flat.number }} квартира</td>
                                <td>{{ flat.way_desc }}</td>
                            </tr>
                        {% endfor %}
                      </table>
                  </div>
                </div>
              </div>
        {% endfor %}
        </div>
{% endblock %}
{% block markers %}
    {% for house in object.sector.get_houses_into %}
        set_popup({{ house.id }},"{{ house }}({{ house.flat_count }})")
        set_marker({{ house.id }}, {{ house.gps_pos }})
    {% endfor %}
{% endblock %}